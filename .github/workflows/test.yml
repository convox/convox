name: test
on: pull_request
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v1
      - name: builder
        run: docker buildx create --use --name builder
      - name: build
        run: docker buildx build --platform linux/amd64,linux/arm64 --load .
  test:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v1
      - name: test
        run: make test
