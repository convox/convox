# atom

Transactional updates and rollbacks of Kubernetes objects

## State Machine

```
                                        ┌ ─ ─ ─ updating  ─ ─ ┐

                                        │  ┌───────────────┐  │
                                           │    Pending    │◀───────────────────────────────┐
                                        │  └───────┬───────┘  │                             │
                                                   ▼                                        │
                                        │  ┌───────────────┐  │                             │
                                           │   Updating    ├──────────────────┐             │
                                        │  └───────┬───────┘  │               │             │
                                                   │                          │             │
                                        └ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ┘               │             │
                                                   │                          │             │
           ┌───────────────────┬───────────────────┤                          │             │
┌ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ┐    ┌ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ┐  │
           ▼                   ▼                   ▼                          ▼             │
│  ┌───────────────┐   ┌───────────────┐   ┌───────────────┐  │    │  ┌───────────────┐  │  │
   │   Cancelled   │   │   Deadline    │   │     Error     │          │    Running    ├─────┤
│  └───────┬───────┘   └───────┬───────┘   └───────┬───────┘  │    │  └───────────────┘  │  │
           │                   │                   │                                        │
│          └───────────────────┼───────────────────┘          │    │  ┌───────────────┐  │  │
                               ▼                                 ┌───▶│   Reverted    ├─────┤
│                      ┌───────────────┐                      │  │ │  └───────────────┘  │  │
                       │   Rollback    ├─────────────────────────┤                          │
│                      └───────────────┘                      │  │ │  ┌───────────────┐  │  │
                                                                 └───▶│    Failure    ├─────┘
└ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ rollback  ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┘    │  └───────────────┘  │

                                                                   └ ─ ─ ─ running ─ ─ ─ ┘
```
